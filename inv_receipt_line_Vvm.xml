<GroupBox Name="GBDVinv_receipt_line" cols="xs12 sm12 md12 lg12"><Ctrls>
<ListCtrl Name="inv_receipt_line_vLst" ToolTip="ttp_inv_receipt_line" Size="700,180" Heading="reference_key_value,120;item_number,120;item_name,120;transaction_quantity,75;uom_name,120;item_description,120;subinventory_id,120;locator_id,120;lot_number,120;created_by,60;creation_date,150;last_update_by,60;last_update_date,150;item_id_m,60;inv_receipt_line_id,60;status,30;" loadedclick="0">
	<DbDetails >
<DbTable>xbs.inv_receipt_line i left join xbs.item i0 on i.item_id_m=i0.item_id_m left join xbs.uom u on i.uom_id=u.uom_id left join xbs.subinventory s on i.subinventory_id=s.subinventory_id left join xbs.locator l on i.locator_id=l.locator_id left join xbs.inv_lot_number i1 on i.lot_number=i1.inv_lot_number_id left join xbs.currency c on i.currency=c.currency_id</DbTable>
<Index>inv_receipt_line_id</Index>
<Data>i.reference_key_value,i0.item_number,i0.item_name,i.transaction_quantity,u.uom_name,i0.item_description,s.subinventory subinventory_id,l.locator locator_id,i1.lot_number lot_number,i.created_by,i.creation_date,i.last_update_by,i.last_update_date,i0.item_id_m,i.inv_receipt_line_id,i.status</Data>
<Order>inv_receipt_line_id</Order></DbDetails>
<operator refresh="1" firstpage="1" prepage="1" nextpage="1">
<op text="addone" mustselected="0"><if cond="!%{inv_receipt_header_id}"><alert expr="请先添加或选择已有项目！"/><else/><assign name="$parent.inv_receipt_line.transaction_type_id" expr="%{transaction_type_id[transaction_type_id]}"/><DbDetails><Where>inv_receipt_header_id='%{inv_receipt_header_id}' and status=1519</Where></DbDetails><submit next="$parent.inv_receipt_line.inv_receipt_header_id" namelist="DbDetails"/>
<if cond="%{transaction_type_id[transaction_type_id]}==5"><assign name="$parent.inv_receipt_line.reference_key_name" expr="po_line" function="setsel"/><DbDetails fcsm="1"><DbTable>po_line pl join item i on i.item_id_m=pl.item_id_m and i.org_id=pl.receving_org_id</DbTable><Index>po_line_id</Index><Data>concat(line_number,' ',item_number) title,pl.item_id_m,unit_price,pl.uom_id uom,line_price amount,i.item_description,line_quantity transaction_quantity,i.org_id,po_line_id refid</Data><Where>po_header_id='%{reference_key_value[refid]}'</Where></DbDetails><submit next="$parent.inv_receipt_line.reference_key_value" namelist="DbDetails"/>
<elseif cond="%{transaction_type_id[transaction_type_id]}==23"/><assign name="$parent.inv_receipt_line.reference_key_name" expr="sd_so_line" function="setsel"/><DbDetails fcsm="1"><DbTable>sd_so_line sl join item i on i.item_id_m=sl.item_id_m and i.org_id=sl.shipping_org_id</DbTable><Index>sd_so_line_id</Index><Data>concat(line_number,' ',item_number) title,sl.item_id_m,unit_price,sl.uom_id uom,line_price amount,i.item_description,line_quantity transaction_quantity,i.org_id,sd_so_line_id refid</Data><Where>sd_so_header_id='%{reference_key_value[refid]}'</Where></DbDetails><submit next="$parent.inv_receipt_line.reference_key_value" namelist="DbDetails"/></if></if>
</op>
<op text="modify"><assign name="$parent.inv_receipt_line.transaction_type_id" expr="%{transaction_type_id[transaction_type_id]}"/><DbDetails><Where>inv_receipt_header_id='%{inv_receipt_header_id}'</Where></DbDetails><submit next="$parent.inv_receipt_line.inv_receipt_header_id" namelist="DbDetails"/>
<if cond="%{transaction_type_id[transaction_type_id]}==5"><assign name="$parent.inv_receipt_line.reference_key_name" expr="po_line" function="setsel"/><DbDetails fcsm="1"><DbTable>po_line pl join item i on i.item_id_m=pl.item_id_m and i.org_id=pl.receving_org_id</DbTable><Index>po_line_id</Index><Data>concat(line_number,' ',item_number) title,pl.item_id_m,unit_price,pl.uom_id uom,line_price amount,i.item_description,line_quantity transaction_quantity,i.org_id,po_line_id refid</Data><Where>po_header_id='%{reference_key_value[refid]}'</Where></DbDetails><submit next="$parent.inv_receipt_line.reference_key_value" namelist="DbDetails"/>
<elseif cond="%{transaction_type_id[transaction_type_id]}==23"/><assign name="$parent.inv_receipt_line.reference_key_name" expr="sd_so_line" function="setsel"/><DbDetails fcsm="1"><DbTable>sd_so_line sl join item i on i.item_id_m=sl.item_id_m and i.org_id=sl.shipping_org_id</DbTable><Index>sd_so_line_id</Index><Data>concat(line_number,' ',item_number) title,sl.item_id_m,unit_price,sl.uom_id uom,line_price amount,i.item_description,line_quantity transaction_quantity,i.org_id,sd_so_line_id refid</Data><Where>sd_so_header_id='%{reference_key_value[refid]}'</Where></DbDetails><submit next="$parent.inv_receipt_line.reference_key_value" namelist="DbDetails"/>
</if><DbDetails><Where>inv_receipt_line_id='%{inv_receipt_line_vLst[inv_receipt_line_id]}' and status=1519</Where></DbDetails><submit namelist="DbDetails" next="$parent.inv_receipt_line.inv_receipt_lineLst"/></op>
<op text="delete"><assign name="topmost" expr="sql:delete il from inv_receipt_line il join inv_receipt_header ih on il.inv_receipt_header_id=ih.inv_receipt_header_id where inv_receipt_line_id=%{inv_receipt_line_vLst[inv_receipt_line_id]} and ih.status=1519"/><submit/></op>
</operator>
</ListCtrl>
</Ctrls></GroupBox>